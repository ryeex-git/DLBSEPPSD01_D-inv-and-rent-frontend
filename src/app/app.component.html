<div class="navigation">
  <ng-container *ngIf="(browser$ | async); else ssrShell">
  <mat-sidenav-container class="h-screen">
    <mat-sidenav mode="side" [(opened)]="sidenavOpen">
      <mat-nav-list>
        <a mat-list-item routerLink="/items" routerLinkActive="active" data-testid="nav-items">
          <mat-icon>inventory_2</mat-icon><span>Inventar</span>
        </a>
        <a mat-list-item routerLink="/reservations" routerLinkActive="active" data-testid="nav-reservations">
          <mat-icon>event</mat-icon><span>Reservierungen</span>
        </a>
        <a mat-list-item routerLink="/admin" routerLinkActive="active" data-testid="nav-admin">
          <mat-icon>admin_panel_settings</mat-icon><span>Admin</span>
        </a>
      </mat-nav-list>
    </mat-sidenav>

    <mat-sidenav-content>
      <mat-toolbar color="primary">
        <button mat-icon-button (click)="sidenavOpen = !sidenavOpen" aria-label="Menü umschalten">
          <mat-icon>menu</mat-icon>
        </button>
        <span class="flex-1 pl-2">Inventar- & Ausleihverwaltung</span>

        <mat-chip-set aria-label="Adminstatus">
          <!-- <mat-chip [color]="isAdmin ? 'accent' : undefined" [selected]="isAdmin" data-testid="admin-status-chip"> -->
            <mat-chip [color]="(isAdmin$ | async) ? 'accent' : undefined" data-testid="admin-status-chip">
            <mat-icon>{{ (isAdmin$ | async) ? 'verified_user' : 'person' }}</mat-icon>
            {{ (isAdmin$ | async) ? 'Adminmodus aktiv' : 'Nutzermodus' }}
          </mat-chip>
        </mat-chip-set>
 
        <button mat-stroked-button *ngIf="!(isAdmin$ | async)" (click)="enterAdmin()">Adminmodus</button>
        <button mat-stroked-button color="warn" *ngIf="(isAdmin$ | async)" (click)="exitAdmin()">Admin aus</button>

        <!-- <button mat-stroked-button class="ml-3" (click)="openAdminPinDialog()" data-testid="btn-admin-pin">
          <mat-icon>lock</mat-icon>
          {{ isAdmin ? 'Admin-PIN ändern' : 'Adminmodus' }}
        </button> -->
      </mat-toolbar>

      <mat-progress-bar *ngIf="(loading$ | async) === true" mode="indeterminate"></mat-progress-bar>


      <div class="p-4">
        <router-outlet></router-outlet>
      </div>
    </mat-sidenav-content>
  </mat-sidenav-container>
  </ng-container>
</div>

<ng-template #ssrShell>
  <header class="p-4">Inventar- & Ausleihverwaltung</header>
  <main class="p-4"></main>
</ng-template>